/*
Script generated by Aqua Data Studio 16.0.5-13 on Jul-31-2017 09:54:20 AM
Database: kicker
Schema: public
Objects: SEQUENCE, RULE, TABLE, VIEW, PROCEDURE, FUNCTION, INDEX, TRIGGER
*/
ALTER TABLE "public"."games_users"
	DROP CONSTRAINT "games_users_user_id_foreign" CASCADE 
GO
ALTER TABLE "public"."games_users"
	DROP CONSTRAINT "games_users_game_id_foreign" CASCADE 
GO
ALTER TABLE "public"."complaints"
	DROP CONSTRAINT "complaints_user_id_foreign" CASCADE 
GO
ALTER TABLE "public"."complaints"
	DROP CONSTRAINT "complaints_game_id_foreign" CASCADE 
GO
ALTER TABLE "public"."users"
	DROP CONSTRAINT "users_email_unique" CASCADE 
GO
DROP INDEX "public"."users_pkey"
GO
DROP INDEX "public"."users_email_unique"
GO
DROP INDEX "public"."password_resets_token_index"
GO
DROP INDEX "public"."password_resets_email_index"
GO
DROP INDEX "public"."index_user_rating"
GO
DROP INDEX "public"."index_user_is_admin"
GO
DROP INDEX "public"."games_users_pkey"
GO
DROP INDEX "public"."games_pkey"
GO
DROP INDEX "public"."complaints_pkey"
GO
DROP TABLE "public"."users"
GO
DROP TABLE "public"."password_resets"
GO
DROP TABLE "public"."migrations"
GO
DROP TABLE "public"."games_users"
GO
DROP TABLE "public"."games"
GO
DROP TABLE "public"."complaints"
GO
DROP SEQUENCE "public"."users_id_seq"
GO
DROP SEQUENCE "public"."games_users_id_seq"
GO
DROP SEQUENCE "public"."games_id_seq"
GO
DROP SEQUENCE "public"."complaints_id_seq"
GO

CREATE SEQUENCE "public"."complaints_id_seq"
	INCREMENT BY 1
	NO MINVALUE
	NO MAXVALUE
	START WITH 1
	CACHE 1
	NO CYCLE
GO
CREATE SEQUENCE "public"."games_id_seq"
	INCREMENT BY 1
	NO MINVALUE
	NO MAXVALUE
	START WITH 1
	CACHE 1
	NO CYCLE
GO
CREATE SEQUENCE "public"."games_users_id_seq"
	INCREMENT BY 1
	NO MINVALUE
	NO MAXVALUE
	START WITH 1
	CACHE 1
	NO CYCLE
GO
CREATE SEQUENCE "public"."users_id_seq"
	INCREMENT BY 1
	NO MINVALUE
	NO MAXVALUE
	START WITH 1
	CACHE 1
	NO CYCLE
GO
CREATE TABLE "public"."complaints"  ( 
	"id"        	serial NOT NULL,
	"created_at"	timestamp NULL,
	"updated_at"	timestamp NULL,
	"game_id"   	int4 NOT NULL,
	"user_id"   	int4 NOT NULL,
	"reason"    	varchar(255) NULL,
	PRIMARY KEY("id")
)
GO
CREATE TABLE "public"."games"  ( 
	"id"           	serial NOT NULL,
	"team_a_points"	int4 NOT NULL,
	"team_b_points"	int4 NOT NULL,
	"created_at"   	timestamp NULL,
	"updated_at"   	timestamp NULL,
	"played_at"    	timestamp NULL,
	"status"       	int4 NOT NULL DEFAULT 1,
	PRIMARY KEY("id")
)
GO
CREATE TABLE "public"."games_users"  ( 
	"id"           	serial NOT NULL,
	"game_id"      	int4 NOT NULL,
	"user_id"      	int4 NOT NULL,
	"team_index"   	varchar(255) NOT NULL,
	"rating_before"	int4 NOT NULL,
	"rating_after" 	int4 NOT NULL,
	"created_at"   	timestamp NULL,
	"updated_at"   	timestamp NULL,
	PRIMARY KEY("id")
)
GO
CREATE TABLE "public"."migrations"  ( 
	"migration"	varchar(255) NOT NULL,
	"batch"    	int4 NOT NULL 
	)
GO
CREATE TABLE "public"."password_resets"  ( 
	"email"     	varchar(255) NOT NULL,
	"token"     	varchar(255) NOT NULL,
	"created_at"	timestamp NOT NULL 
	)
GO
CREATE TABLE "public"."users"  ( 
	"id"            	serial NOT NULL,
	"name"          	varchar(255) NOT NULL,
	"email"         	varchar(255) NOT NULL,
	"password"      	varchar(255) NOT NULL,
	"remember_token"	varchar(100) NULL,
	"created_at"    	timestamp NULL,
	"updated_at"    	timestamp NULL,
	"facebook_id"   	varchar(255) NULL,
	"count_wins"    	int4 NULL DEFAULT 0,
	"count_draws"   	int4 NULL DEFAULT 0,
	"count_looses"  	int4 NULL DEFAULT 0,
	"rating"        	int4 NULL DEFAULT 0,
	"avatar_url"    	varchar(255) NULL,
	"is_admin"      	bool NULL DEFAULT false,
	"deleted"       	bool NOT NULL DEFAULT false,
	PRIMARY KEY("id")
)
GO
CREATE UNIQUE INDEX "complaints_pkey"
	ON "public"."complaints" USING btree ("id")
GO
CREATE UNIQUE INDEX "games_pkey"
	ON "public"."games" USING btree ("id")
GO
CREATE UNIQUE INDEX "games_users_pkey"
	ON "public"."games_users" USING btree ("id")
GO
CREATE INDEX "index_user_is_admin"
	ON "public"."users" USING btree ("is_admin")
GO
CREATE INDEX "index_user_rating"
	ON "public"."users" USING btree ("rating")
GO
CREATE INDEX "password_resets_email_index"
	ON "public"."password_resets" USING btree ("email")
GO
CREATE INDEX "password_resets_token_index"
	ON "public"."password_resets" USING btree ("token")
GO
CREATE UNIQUE INDEX "users_email_unique"
	ON "public"."users" USING btree ("email")
GO
CREATE UNIQUE INDEX "users_pkey"
	ON "public"."users" USING btree ("id")
GO

ALTER TABLE "public"."users"
	ADD CONSTRAINT "users_email_unique"
	UNIQUE ("email")
GO
ALTER TABLE "public"."complaints"
	ADD CONSTRAINT "complaints_user_id_foreign"
	FOREIGN KEY("user_id")
	REFERENCES "public"."users"("id")
	ON DELETE CASCADE 
	ON UPDATE CASCADE 
GO
ALTER TABLE "public"."complaints"
	ADD CONSTRAINT "complaints_game_id_foreign"
	FOREIGN KEY("game_id")
	REFERENCES "public"."games"("id")
	ON DELETE CASCADE 
	ON UPDATE CASCADE 
GO
ALTER TABLE "public"."games_users"
	ADD CONSTRAINT "games_users_user_id_foreign"
	FOREIGN KEY("user_id")
	REFERENCES "public"."users"("id")
	ON DELETE CASCADE 
	ON UPDATE CASCADE 
GO
ALTER TABLE "public"."games_users"
	ADD CONSTRAINT "games_users_game_id_foreign"
	FOREIGN KEY("game_id")
	REFERENCES "public"."games"("id")
	ON DELETE CASCADE 
	ON UPDATE CASCADE 
GO
